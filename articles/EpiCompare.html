<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`EpiCompare`: Getting started • EpiCompare</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`EpiCompare`: Getting started">
<meta property="og:description" content="EpiCompare">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiCompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/EpiCompare.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/docker.html">Docker/Singularity Containers</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/neurogenomics/EpiCompare/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>EpiCompare</code>: Getting started</h1>
                        <h4 data-toc-skip class="author"><h5> ¶
<i>Authors</i>: Sera Choi ¶ </h5></h4>
            
            <h4 data-toc-skip class="date"><h5> ¶ <i>Updated</i>:
Oct-17-2022 ¶ </h5></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/neurogenomics/EpiCompare/blob/HEAD/vignettes/EpiCompare.Rmd" class="external-link"><code>vignettes/EpiCompare.Rmd</code></a></small>
      <div class="hidden name"><code>EpiCompare.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <em>EpiCompare</em> package is designed to facilitate the
comparison of epigenomic datasets for quality control and benchmarking
purposes. The package combines several downstream analysis tools for
epigenomic data and generates a single report that collates all results
of the analysis. This allows users to conduct downstream analysis of
multiple epigenomic datasets simultaneously and compare the results in a
simple and efficient way.</p>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>For many years, ChIP-seq has been the standard method for epigenomic
profiling, but it suffers from a host of limitations. Recently, many
other epigenomic technologies (e.g. CUT&amp;Run, CUT&amp;Tag and TIP-seq
etc.), designed to overcome these constraints, have been developed. To
better understand the performance of these novel approaches, it is
important that we systematically compare these technologies and
benchmark against a “gold-standard”.</p>
<p>There are many tools in R (e.g. <em>ChIPseeker</em>) that can be used
to conduct downstream analysis and comparison of epigenomic datasets.
However, these are often scattered across different packages and
difficult to use for researchers with none or little computational
experience.</p>
<p><em>EpiCompare</em> is designed to provide a simple and comprehensive
way of analysing and comparing epigenomic datasets. It combines many
useful downstream analysis tools, which can easily be controlled by
users and it collates the results in a single report. This allows
researchers to systematically compare different epigenomic
technologies.</p>
<p>While the main functionality of <em>EpiCompare</em> is to contrast
epigenomic technologies, it can also be used to compare datasets
generated using different experimental conditions and data analysis
workflows of one technology. This can help researchers to establish a
consensus regarding the optimal use of the method.</p>
<p>Currently, <em>EpiCompare</em> only works for human genome as it uses
human-based hg19 and/or hg38 genome references.</p>
</div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The <em>EpiCompare</em> package contains a small subset of histone
mark H3K27ac profile data obtained/generated from:</p>
<ul>
<li>ENCODE (data accession: ENCFF044JNJ)</li>
<li>CUT&amp;Tag from Kaya-Okur et al., (2019). (PMID: 31036827)</li>
<li>CUT&amp;Run from Meers et al., (2019). (PMID: 31232687)</li>
</ul>
<p>It also contains human genome hg19 and hg38 blacklisted regions
obtained from ENCODE. The ENCODE blacklist includes regions of the
genome that have anomalous and/or unstructured signals independent of
the cell-line or experiment. Removal of ENCODE blacklist is recommended
for quality measure.</p>
<p>These dataset will be used to showcase <em>EpiCompare</em>
functionality</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the package, run the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"EpiCompare"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-epicompare">Running <em>EpiCompare</em><a class="anchor" aria-label="anchor" href="#running-epicompare"></a>
</h2>
<p>In this example analysis, we will compare CUT&amp;Run and CUT&amp;Tag
of histone mark H3K27ac against ENCODE ChIP-seq.</p>
<div class="section level3">
<h3 id="load-package-and-example-datasets">Load package and example datasets<a class="anchor" aria-label="anchor" href="#load-package-and-example-datasets"></a>
</h3>
<p>Once installed, load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/neurogenomics/EpiCompare" class="external-link">EpiCompare</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'Biostrings::pattern' by 'grid::pattern' when</span></span>
<span><span class="co">## loading 'genomation'</span></span></code></pre>
<p>Load example datasets used in this analysis:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"encode_H3K27ac"</span><span class="op">)</span> <span class="co"># ENCODE ChIP-seq</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CnT_H3K27ac"</span><span class="op">)</span> <span class="co"># CUT&amp;Tag</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CnR_H3K27ac"</span><span class="op">)</span> <span class="co"># CUT&amp;Run</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hg19_blacklist"</span><span class="op">)</span> <span class="co"># hg19 genome blacklist </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CnT_H3K27ac_picard"</span><span class="op">)</span> <span class="co"># CUT&amp;Tag Picard summary output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CnR_H3K27ac_picard"</span><span class="op">)</span> <span class="co"># CUT&amp;Run Picard summary output</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-input-data">Prepare input data<a class="anchor" aria-label="anchor" href="#prepare-input-data"></a>
</h3>
<div class="section level4">
<h4 id="peaklist">Peaklist<a class="anchor" aria-label="anchor" href="#peaklist"></a>
</h4>
<p><em>EpiCompare</em> accepts datasets both as <code>GRanges</code>
object and as paths to BED files. Peakfiles (<code>GRanges</code> or
paths) that you would like to analyse must be listed and named (see
below).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To import BED files as GRanges object</span></span>
<span><span class="va">peak_GRanges</span> <span class="op">&lt;-</span><span class="fu">ChIPseeker</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ChIPseeker/man/readPeakFile.html" class="external-link">readPeakFile</a></span><span class="op">(</span><span class="st">"/path/to/peak/file.bed"</span>,as <span class="op">=</span> <span class="st">"GRanges"</span><span class="op">)</span></span>
<span><span class="co"># EpiCompare also accepts paths (to BED files) as input </span></span>
<span><span class="va">peak_path</span> <span class="op">&lt;-</span> <span class="st">"/path/to/BED/file1.bed"</span></span>
<span><span class="co"># Create named peak list</span></span>
<span><span class="va">peaklist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">peak_GRanges</span>, <span class="va">peak_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">peaklist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span>, <span class="st">"sample2"</span><span class="op">)</span></span></code></pre></div>
<p>In this example, we will use built-in data, which have been converted
into <code>GRanges</code> object previously (<code>CnT_H3K27ac</code>
and <code>CnR_H3K27ac</code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peaklist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CnT_H3K27ac</span>, <span class="va">CnR_H3K27ac</span><span class="op">)</span> <span class="co"># create list of peakfiles </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">peaklist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CnT"</span>, <span class="st">"CnR"</span><span class="op">)</span> <span class="co"># set names </span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="blacklist">Blacklist<a class="anchor" aria-label="anchor" href="#blacklist"></a>
</h4>
<p>ENCODE blacklist contains regions of the genome that have anomalous
and/or unstructured signals independent of the cell-line or experiment.
Removal of these regions from peakfiles is recommended for quality
measure.</p>
<p><em>EpiCompare</em> contains two blacklist files, hg19 and hg38,
downloaded from <a href="https://github.com/Boyle-Lab/Blacklist" class="external-link">here</a>.</p>
<p>In this example analysis, since all peakfiles
(<code>encode_H3K27ac</code>, <code>CnT_H3K27ac</code>,
<code>CnR_H3K27ac</code>) were generated using human genome reference
build hg19, <code>hg19_blacklist</code> will be used. For hg38, use
<code>data(hg38_blacklist)</code>.</p>
<p>Please ensure that you specify the correct blacklist.</p>
</div>
<div class="section level4">
<h4 id="picard-summary-files">Picard summary files<a class="anchor" aria-label="anchor" href="#picard-summary-files"></a>
</h4>
<p>Note that this is <em>OPTIONAL</em>. If you want the report to
include metrics on DNA fragments (e.g. mapped fragments and duplication
rate), please input summary files from Picard.</p>
<p><a href="https://broadinstitute.github.io/picard/command-line-overview.html#MarkDuplicates" class="external-link">Picard
<em>MarkDuplicates</em></a> can be used to mark duplicate reads that are
found within the alignment. This tool outputs a metrics file with the
ending <code>.MarkDuplicates.metrics.txt</code>. To import this text
file into R as data frame, use:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">picard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"/path/to/Picard/.MarkDuplicates.metrics.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>In this example. we will use built-in data, which have been converted
into data frame previously (<code>CnT_H3K27ac_picard</code> and
<code>CnR_H3K27ac_picard</code>). The files must be listed and
named:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create list of Picard summary</span></span>
<span><span class="va">picard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CnT_H3K27ac_picard</span>, <span class="va">CnR_H3K27ac_picard</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">picard</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CnT"</span>, <span class="st">"CnR"</span><span class="op">)</span> <span class="co"># set names </span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reference-file">Reference file<a class="anchor" aria-label="anchor" href="#reference-file"></a>
</h4>
<p>This is OPTIONAL. If reference peak file is provided,
<code>stat_plot</code> and <code>chromHMM_plot</code> of overlapping
peaks are included in the report (see <em>Optional plots</em> section
below).</p>
<p>Reference file must be listed and named. In this example, we will use
built-in data (<code>encode_H3K27ac</code>), which has been converted to
<code>GRanges</code> previously:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reference_peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ENCODE_H3K27ac"</span> <span class="op">=</span> <span class="va">encode_H3K27ac</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="output-directory">Output Directory<a class="anchor" aria-label="anchor" href="#output-directory"></a>
</h4>
<p>When running <code><a href="../reference/EpiCompare.html">EpiCompare()</a></code>, please ensure that you
specify <code>output_dir</code>. All outputs (figures and HTML report)
will be saved in the specified <code>output_dir</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="run-epicompare">Run EpiCompare<a class="anchor" aria-label="anchor" href="#run-epicompare"></a>
</h3>
<p>Running EpiCompare is done using the function,
<code><a href="../reference/EpiCompare.html">EpiCompare()</a></code> . Users can choose which analyses to run and
include in the report by setting parameters to <code>TRUE</code> or
<code>FALSE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/EpiCompare.html">EpiCompare</a></span><span class="op">(</span>peakfiles <span class="op">=</span> <span class="va">peaklist</span>,</span>
<span>           genome_build <span class="op">=</span> <span class="st">"hg19"</span>,</span>
<span>           blacklist <span class="op">=</span> <span class="va">hg19_blacklist</span>,</span>
<span>           picard_files <span class="op">=</span> <span class="va">picard</span>,</span>
<span>           reference <span class="op">=</span> <span class="va">reference_peak</span>,</span>
<span>           upset_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           stat_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           chromHMM_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           chromHMM_annotation <span class="op">=</span> <span class="st">"K562"</span>,</span>
<span>           chipseeker_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           enrichment_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           tss_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           interact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           save_output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           output_filename <span class="op">=</span> <span class="st">"EpiCompare_test"</span>,</span>
<span>           output_timestamp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Assuming same genome_build for all file inputs: </span></span>
<span><span class="co">##  'peakfiles':  hg19 </span></span>
<span><span class="co">##  'reference':  hg19 </span></span>
<span><span class="co">##  'blacklist':  hg19</span></span></code></pre>
<pre><code><span><span class="co">## Preparing peaklist.</span></span></code></pre>
<pre><code><span><span class="co">## grlist is already in the output_build format. Skipping liftover.</span></span></code></pre>
<pre><code><span><span class="co">## Preparing reference.</span></span></code></pre>
<pre><code><span><span class="co">## grlist is already in the output_build format. Skipping liftover.</span></span>
<span><span class="co">## grlist is already in the output_build format. Skipping liftover.</span></span></code></pre>
<pre><code><span><span class="co">## --- Running peak_info() ---</span></span></code></pre>
<pre><code><span><span class="co">## Done.</span></span></code></pre>
<pre><code><span><span class="co">## --- Running width_boxplot() ---</span></span></code></pre>
<pre><code><span><span class="co">## Done.</span></span></code></pre>
<pre><code><span><span class="co">## --- Running overlap_heatmap() ---</span></span></code></pre>
<pre><code><span><span class="co">## Done.</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Done in 0.135 min."</span></span></code></pre>
<pre><code><span><span class="co">## All outputs saved to: /tmp/RtmpzceaZ0</span></span></code></pre>
<pre><code><span><span class="co">## [1] "/tmp/RtmpzceaZ0/EpiCompare_test.html"</span></span></code></pre>
<div class="section level4">
<h4 id="optional-plots">Optional plots<a class="anchor" aria-label="anchor" href="#optional-plots"></a>
</h4>
<p>By default, these plots will not be included in the report unless set
<code>TRUE</code>.</p>
<ul>
<li>
<code>upset_plot</code> : Upset plot showing the number of
overlapping peaks between samples. <em>EpiCompare</em> uses
<code>UpSetR</code> package.<br>
</li>
<li>
<code>stat_plot</code> : A <code>reference</code> peakfile must be
included for this plot. The plot displays distribution of statistical
significance (q-values) of sample peaks that are
overlapping/non-overlapping with the <code>reference</code>
dataset.</li>
<li>
<code>chromHMM_plot</code> : <a href="http://compbio.mit.edu/ChromHMM/#:~:text=ChromHMM%20is%20software%20for%20learning,and%20spatial%20patterns%20of%20marks." class="external-link">ChromHMM</a>
annotation of peaks. If <code>reference</code> is provided, ChromHMM
annotation of overlapping and non-overlapping peaks with the
<code>reference</code> is also included in the report.</li>
<li>
<code>chipseeker_plot</code> : <code>ChIPseeker</code> functional
annotation of peaks.</li>
<li>
<code>enrichment_plot</code> : KEGG pathway and GO enrichment
analysis of peaks.</li>
<li>
<code>tss_plot</code> : Peak frequency around (+/- 3000bp)
transcriptional start site. Note that it may take awhile to generate
this plot for large sample sizes.</li>
</ul>
</div>
<div class="section level4">
<h4 id="other-options">Other options<a class="anchor" aria-label="anchor" href="#other-options"></a>
</h4>
<ul>
<li>
<code>chromHMM_annotation</code> : Cell-line annotation for
ChromHMM. Default is K562. Options are:
<ul>
<li>“K562” = K-562 cells</li>
<li>“Gm12878” = Cellosaurus cell-line GM12878</li>
<li>“H1hesc” = H1 Human Embryonic Stem Cell</li>
<li>“Hepg2” = Hep G2 cell</li>
<li>“Hmec” = Human Mammary Epithelial Cell</li>
<li>“Hsmm” = Human Skeletal Muscle Myoblasts</li>
<li>“Huvec” = Human Umbilical Vein Endothelial Cells</li>
<li>“Nhek” = Normal Human Epidermal Keratinocytes</li>
<li>“Nhlf” = Normal Human Lung Fibroblasts</li>
</ul>
</li>
<li>
<code>interact</code> : By default, all heatmaps (percentage overlap
and ChromHMM heatmaps) in the report will be interactive. If set FALSE,
all heatmaps will be static. N.B. If <code>interact=TRUE</code>,
interactive heatmaps will be saved as html files, which may take time
for larger sample sizes.</li>
<li>
<code>output_filename</code> : By default, the report is named
EpiCompare.html. You can specify the filename of the report here.</li>
<li>
<code>output_timestamp</code> : By default FALSE. If TRUE, the
filename of the report includes the date.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p><em>EpiCompare</em> outputs</p>
<ul>
<li>An HTML report consisting of three sections:
<ul>
<li><ol style="list-style-type: decimal">
<li>
<strong>General Metrics</strong>: Metrics on peaks (percentage of
blacklisted and non-standard peaks, and peak widths) and fragments
(duplication rate) of samples.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>
<strong>Peak Overlap</strong>: Percentage and statistical
significance of overlapping and non-overlapping peaks. Also includes
upset plot.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>
<strong>Functional Annotation</strong>: Functional annotation
(ChromHMM, ChIPseeker and enrichment analysis) of peaks. Also includes
peak enrichment around TSS.</li>
</ol></li>
</ul>
</li>
<li>
<code>EpiCompare_file</code> containing all plots generated by
EpiCompare if <code>save_output = TRUE</code>.</li>
</ul>
<p>Both outputs are saved in the specified <code>output_dir</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="future-enhancements">Future Enhancements<a class="anchor" aria-label="anchor" href="#future-enhancements"></a>
</h2>
<p>In the current version, <em>EpiCompare</em> only recognizes certain
BED formats. We hope to improve this. Moreover, if there are other
downstream analysis tools that may be suitable in <em>EpiCompare</em>,
feel free to report this through <a href="https://github.com/neurogenomics/EpiCompare" class="external-link">Github</a>.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<details><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] EpiCompare_1.1.3 BiocStyle_2.25.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] utf8_1.2.2                             </span></span>
<span><span class="co">##   [2] tidyselect_1.2.0                       </span></span>
<span><span class="co">##   [3] htmlwidgets_1.5.4                      </span></span>
<span><span class="co">##   [4] RSQLite_2.2.18                         </span></span>
<span><span class="co">##   [5] AnnotationDbi_1.59.1                   </span></span>
<span><span class="co">##   [6] grid_4.2.1                             </span></span>
<span><span class="co">##   [7] BiocParallel_1.31.13                   </span></span>
<span><span class="co">##   [8] scatterpie_0.1.8                       </span></span>
<span><span class="co">##   [9] munsell_0.5.0                          </span></span>
<span><span class="co">##  [10] codetools_0.2-18                       </span></span>
<span><span class="co">##  [11] ragg_1.2.3                             </span></span>
<span><span class="co">##  [12] withr_2.5.0                            </span></span>
<span><span class="co">##  [13] colorspace_2.0-3                       </span></span>
<span><span class="co">##  [14] GOSemSim_2.23.1                        </span></span>
<span><span class="co">##  [15] Biobase_2.57.1                         </span></span>
<span><span class="co">##  [16] filelock_1.0.2                         </span></span>
<span><span class="co">##  [17] highr_0.9                              </span></span>
<span><span class="co">##  [18] knitr_1.40                             </span></span>
<span><span class="co">##  [19] stats4_4.2.1                           </span></span>
<span><span class="co">##  [20] DOSE_3.23.3                            </span></span>
<span><span class="co">##  [21] labeling_0.4.2                         </span></span>
<span><span class="co">##  [22] MatrixGenerics_1.9.1                   </span></span>
<span><span class="co">##  [23] GenomeInfoDbData_1.2.9                 </span></span>
<span><span class="co">##  [24] polyclip_1.10-0                        </span></span>
<span><span class="co">##  [25] seqPattern_1.29.0                      </span></span>
<span><span class="co">##  [26] bit64_4.0.5                            </span></span>
<span><span class="co">##  [27] farver_2.1.1                           </span></span>
<span><span class="co">##  [28] rprojroot_2.0.3                        </span></span>
<span><span class="co">##  [29] vctrs_0.4.2                            </span></span>
<span><span class="co">##  [30] treeio_1.21.2                          </span></span>
<span><span class="co">##  [31] generics_0.1.3                         </span></span>
<span><span class="co">##  [32] xfun_0.33                              </span></span>
<span><span class="co">##  [33] BiocFileCache_2.5.2                    </span></span>
<span><span class="co">##  [34] R6_2.5.1                               </span></span>
<span><span class="co">##  [35] GenomeInfoDb_1.33.10                   </span></span>
<span><span class="co">##  [36] graphlayouts_0.8.2                     </span></span>
<span><span class="co">##  [37] locfit_1.5-9.6                         </span></span>
<span><span class="co">##  [38] bitops_1.0-7                           </span></span>
<span><span class="co">##  [39] BRGenomics_1.9.0                       </span></span>
<span><span class="co">##  [40] cachem_1.0.6                           </span></span>
<span><span class="co">##  [41] fgsea_1.23.4                           </span></span>
<span><span class="co">##  [42] gridGraphics_0.5-1                     </span></span>
<span><span class="co">##  [43] DelayedArray_0.23.2                    </span></span>
<span><span class="co">##  [44] assertthat_0.2.1                       </span></span>
<span><span class="co">##  [45] promises_1.2.0.1                       </span></span>
<span><span class="co">##  [46] BiocIO_1.7.1                           </span></span>
<span><span class="co">##  [47] scales_1.2.1                           </span></span>
<span><span class="co">##  [48] ggraph_2.1.0                           </span></span>
<span><span class="co">##  [49] enrichplot_1.17.2                      </span></span>
<span><span class="co">##  [50] gtable_0.3.1                           </span></span>
<span><span class="co">##  [51] tidygraph_1.2.2                        </span></span>
<span><span class="co">##  [52] rlang_1.0.6                            </span></span>
<span><span class="co">##  [53] genefilter_1.79.0                      </span></span>
<span><span class="co">##  [54] systemfonts_1.0.4                      </span></span>
<span><span class="co">##  [55] splines_4.2.1                          </span></span>
<span><span class="co">##  [56] rtracklayer_1.57.0                     </span></span>
<span><span class="co">##  [57] lazyeval_0.2.2                         </span></span>
<span><span class="co">##  [58] impute_1.71.0                          </span></span>
<span><span class="co">##  [59] BiocManager_1.30.18                    </span></span>
<span><span class="co">##  [60] yaml_2.3.5                             </span></span>
<span><span class="co">##  [61] reshape2_1.4.4                         </span></span>
<span><span class="co">##  [62] GenomicFeatures_1.49.7                 </span></span>
<span><span class="co">##  [63] httpuv_1.6.6                           </span></span>
<span><span class="co">##  [64] qvalue_2.29.0                          </span></span>
<span><span class="co">##  [65] tools_4.2.1                            </span></span>
<span><span class="co">##  [66] bookdown_0.29                          </span></span>
<span><span class="co">##  [67] gridBase_0.4-7                         </span></span>
<span><span class="co">##  [68] ggplotify_0.1.0                        </span></span>
<span><span class="co">##  [69] ggplot2_3.3.6                          </span></span>
<span><span class="co">##  [70] ellipsis_0.3.2                         </span></span>
<span><span class="co">##  [71] gplots_3.1.3                           </span></span>
<span><span class="co">##  [72] jquerylib_0.1.4                        </span></span>
<span><span class="co">##  [73] RColorBrewer_1.1-3                     </span></span>
<span><span class="co">##  [74] BiocGenerics_0.43.4                    </span></span>
<span><span class="co">##  [75] Rcpp_1.0.9                             </span></span>
<span><span class="co">##  [76] plyr_1.8.7                             </span></span>
<span><span class="co">##  [77] progress_1.2.2                         </span></span>
<span><span class="co">##  [78] zlibbioc_1.43.0                        </span></span>
<span><span class="co">##  [79] purrr_0.3.5                            </span></span>
<span><span class="co">##  [80] RCurl_1.98-1.9                         </span></span>
<span><span class="co">##  [81] prettyunits_1.1.1                      </span></span>
<span><span class="co">##  [82] viridis_0.6.2                          </span></span>
<span><span class="co">##  [83] cowplot_1.1.1                          </span></span>
<span><span class="co">##  [84] S4Vectors_0.35.4                       </span></span>
<span><span class="co">##  [85] SummarizedExperiment_1.27.3            </span></span>
<span><span class="co">##  [86] ggrepel_0.9.1                          </span></span>
<span><span class="co">##  [87] fs_1.5.2                               </span></span>
<span><span class="co">##  [88] magrittr_2.0.3                         </span></span>
<span><span class="co">##  [89] data.table_1.14.2                      </span></span>
<span><span class="co">##  [90] matrixStats_0.62.0                     </span></span>
<span><span class="co">##  [91] hms_1.1.2                              </span></span>
<span><span class="co">##  [92] patchwork_1.1.2                        </span></span>
<span><span class="co">##  [93] mime_0.12                              </span></span>
<span><span class="co">##  [94] evaluate_0.17                          </span></span>
<span><span class="co">##  [95] xtable_1.8-4                           </span></span>
<span><span class="co">##  [96] HDO.db_0.99.1                          </span></span>
<span><span class="co">##  [97] XML_3.99-0.11                          </span></span>
<span><span class="co">##  [98] IRanges_2.31.2                         </span></span>
<span><span class="co">##  [99] gridExtra_2.3                          </span></span>
<span><span class="co">## [100] compiler_4.2.1                         </span></span>
<span><span class="co">## [101] biomaRt_2.53.3                         </span></span>
<span><span class="co">## [102] tibble_3.1.8                           </span></span>
<span><span class="co">## [103] KernSmooth_2.23-20                     </span></span>
<span><span class="co">## [104] crayon_1.5.2                           </span></span>
<span><span class="co">## [105] shadowtext_0.1.2                       </span></span>
<span><span class="co">## [106] htmltools_0.5.3                        </span></span>
<span><span class="co">## [107] tzdb_0.3.0                             </span></span>
<span><span class="co">## [108] ggfun_0.0.7                            </span></span>
<span><span class="co">## [109] later_1.3.0                            </span></span>
<span><span class="co">## [110] tidyr_1.2.1                            </span></span>
<span><span class="co">## [111] geneplotter_1.75.0                     </span></span>
<span><span class="co">## [112] aplot_0.1.8                            </span></span>
<span><span class="co">## [113] DBI_1.1.3                              </span></span>
<span><span class="co">## [114] genomation_1.29.0                      </span></span>
<span><span class="co">## [115] tweenr_2.0.2                           </span></span>
<span><span class="co">## [116] ChIPseeker_1.33.2                      </span></span>
<span><span class="co">## [117] dbplyr_2.2.1                           </span></span>
<span><span class="co">## [118] MASS_7.3-58.1                          </span></span>
<span><span class="co">## [119] rappdirs_0.3.3                         </span></span>
<span><span class="co">## [120] boot_1.3-28                            </span></span>
<span><span class="co">## [121] readr_2.1.3                            </span></span>
<span><span class="co">## [122] Matrix_1.5-1                           </span></span>
<span><span class="co">## [123] cli_3.4.1                              </span></span>
<span><span class="co">## [124] parallel_4.2.1                         </span></span>
<span><span class="co">## [125] igraph_1.3.5                           </span></span>
<span><span class="co">## [126] GenomicRanges_1.49.1                   </span></span>
<span><span class="co">## [127] pkgconfig_2.0.3                        </span></span>
<span><span class="co">## [128] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2</span></span>
<span><span class="co">## [129] pkgdown_2.0.6.9000                     </span></span>
<span><span class="co">## [130] GenomicAlignments_1.33.1               </span></span>
<span><span class="co">## [131] plotly_4.10.0                          </span></span>
<span><span class="co">## [132] xml2_1.3.3                             </span></span>
<span><span class="co">## [133] ggtree_3.5.3                           </span></span>
<span><span class="co">## [134] annotate_1.75.0                        </span></span>
<span><span class="co">## [135] bslib_0.4.0                            </span></span>
<span><span class="co">## [136] XVector_0.37.1                         </span></span>
<span><span class="co">## [137] yulab.utils_0.0.5                      </span></span>
<span><span class="co">## [138] stringr_1.4.1                          </span></span>
<span><span class="co">## [139] digest_0.6.29                          </span></span>
<span><span class="co">## [140] Biostrings_2.65.6                      </span></span>
<span><span class="co">## [141] rmarkdown_2.17                         </span></span>
<span><span class="co">## [142] fastmatch_1.1-3                        </span></span>
<span><span class="co">## [143] tidytree_0.4.1                         </span></span>
<span><span class="co">## [144] restfulr_0.0.15                        </span></span>
<span><span class="co">## [145] curl_4.3.3                             </span></span>
<span><span class="co">## [146] shiny_1.7.2                            </span></span>
<span><span class="co">## [147] Rsamtools_2.13.4                       </span></span>
<span><span class="co">## [148] gtools_3.9.3                           </span></span>
<span><span class="co">## [149] rjson_0.2.21                           </span></span>
<span><span class="co">## [150] lifecycle_1.0.3                        </span></span>
<span><span class="co">## [151] nlme_3.1-160                           </span></span>
<span><span class="co">## [152] jsonlite_1.8.2                         </span></span>
<span><span class="co">## [153] BSgenome_1.65.2                        </span></span>
<span><span class="co">## [154] desc_1.4.2                             </span></span>
<span><span class="co">## [155] viridisLite_0.4.1                      </span></span>
<span><span class="co">## [156] fansi_1.0.3                            </span></span>
<span><span class="co">## [157] pillar_1.8.1                           </span></span>
<span><span class="co">## [158] lattice_0.20-45                        </span></span>
<span><span class="co">## [159] KEGGREST_1.37.3                        </span></span>
<span><span class="co">## [160] fastmap_1.1.0                          </span></span>
<span><span class="co">## [161] httr_1.4.4                             </span></span>
<span><span class="co">## [162] plotrix_3.8-2                          </span></span>
<span><span class="co">## [163] survival_3.4-0                         </span></span>
<span><span class="co">## [164] GO.db_3.16.0                           </span></span>
<span><span class="co">## [165] interactiveDisplayBase_1.35.1          </span></span>
<span><span class="co">## [166] glue_1.6.2                             </span></span>
<span><span class="co">## [167] png_0.1-7                              </span></span>
<span><span class="co">## [168] BiocVersion_3.16.0                     </span></span>
<span><span class="co">## [169] bit_4.0.4                              </span></span>
<span><span class="co">## [170] ggforce_0.4.1                          </span></span>
<span><span class="co">## [171] stringi_1.7.8                          </span></span>
<span><span class="co">## [172] sass_0.4.2                             </span></span>
<span><span class="co">## [173] blob_1.2.3                             </span></span>
<span><span class="co">## [174] textshaping_0.3.6                      </span></span>
<span><span class="co">## [175] DESeq2_1.37.6                          </span></span>
<span><span class="co">## [176] AnnotationHub_3.5.2                    </span></span>
<span><span class="co">## [177] caTools_1.18.2                         </span></span>
<span><span class="co">## [178] memoise_2.0.1                          </span></span>
<span><span class="co">## [179] dplyr_1.0.10                           </span></span>
<span><span class="co">## [180] ape_5.6-2</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<div class="section level4">
<h4 id="neurogenomics-lab">
<a href="https://www.neurogenomics.co.uk/inst/report/EpiCompare.html" class="external-link">Neurogenomics
Lab</a><a class="anchor" aria-label="anchor" href="#neurogenomics-lab"></a>
</h4>
<p>UK Dementia Research Institute<br>
Department of Brain Sciences<br>
Faculty of Medicine<br>
Imperial College London<br><a href="https://github.com/neurogenomics" class="external-link">GitHub</a><br><a href="https://hub.docker.com/orgs/neurogenomicslab" class="external-link">DockerHub</a></p>
<p><br></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sera Choi, Brian Schilder, Leyla Abbasova, Alan Murphy, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
